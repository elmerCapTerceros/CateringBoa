<div
    class="flex flex-col flex-auto min-w-0 bg-gradient-to-b from-gray-50 to-gray-100 min-h-screen animate-fade-in"
>
    <div class="flex-auto p-6 sm:p-10">
        <!-- T√≠tulo animado -->
        <div class="flex items-center justify-between mb-8">
            <h2
                class="text-4xl font-extrabold text-gray-800 tracking-tight hover:scale-[1.02] transition-transform duration-300"
            >
                Movimientos
            </h2>

            <!-- Contador con efecto vidrio -->
            <div
                class="relative overflow-hidden backdrop-blur-md bg-white/60 border border-white/40
         shadow-lg px-6 py-3 rounded-2xl text-sm text-gray-700
         transition-all duration-500 hover:scale-[1.03] hover:shadow-xl hover:bg-white/80"
            >
                <span
                    class="absolute inset-0 bg-gradient-to-r from-blue-100/30 to-blue-200/30 opacity-70"
                ></span>
                <div class="relative z-10 flex items-center gap-2 font-medium">
                    Mostrando
                    <span
                        class="font-bold text-blue-600 text-base animate-count"
                    >{{ movimientosFiltrados.length }}</span
                    >
                    de
                    <span class="font-bold text-gray-800 text-base"
                    >{{ movimientos.length }}</span
                    >
                    registros
                </div>

            </div>

        </div>



        <!-- Formulario de Filtros -->
        <form
            [formGroup]="filtroForm"
            class="mb-6 bg-white p-6 rounded-xl shadow-lg border border-gray-200 hover:shadow-2xl transition-shadow duration-300"
        >
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- Filtro por Almac√©n -->
                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Filtrar por almac√©n</mat-label>
                    <mat-select formControlName="almacen">
                        @for (almacen of almacenes; track almacen.value) {
                            <mat-option [value]="almacen.value">
                                {{ almacen.viewValue }}
                            </mat-option>
                        }
                    </mat-select>
                </mat-form-field>

                <!-- Filtro por Fecha -->
                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Filtrar por fecha</mat-label>
                    <input
                        matInput
                        [matDatepicker]="picker"
                        formControlName="fecha"
                        class="focus:ring-blue-500 focus:border-blue-500"
                    />
                    <mat-datepicker-toggle
                        matIconSuffix
                        [for]="picker"
                    ></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>


            </div>

            <!-- Bot√≥n para limpiar filtros -->
            <div class="flex justify-end">
                <button
                    type="button"
                    (click)="limpiarFiltros()"
                    class="px-5 py-2 text-sm rounded-md font-semibold bg-blue-50 text-blue-700 hover:bg-blue-100 transition-all duration-300 hover:shadow-md"
                >
                    üîÑ Limpiar filtros
                </button>
            </div>
            <button type="submit" class="w-full py-2 mt-4 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition-all duration-300">
                Crear Movimiento
            </button>
        </form>

        <!-- Tabla de Movimientos -->
        <div
            class="overflow-x-auto bg-white rounded-xl shadow-lg border border-gray-200 animate-fade-in-up"
        >
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-blue-600 text-white">
                <tr>
                    <th
                        class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider"
                    >
                        Almac√©n
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider"
                    >
                        Fecha
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider"
                    >
                        Item
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider"
                    >
                        Cantidad
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider"
                    >
                        Movimiento
                    </th>
                    <th
                        class="px-6 py-3 text-center text-xs font-semibold uppercase tracking-wider"
                    >
                        Acciones
                    </th>
                </tr>
                </thead>

                <tbody class="bg-white divide-y divide-gray-100">
                    @for (mov of movimientosPaginados; track mov.id) {
                        <tr
                            class="hover:bg-blue-50 transition-all duration-300 hover:scale-[1.01]"
                        >
                            <td
                                class="px-6 py-4 text-sm text-gray-800 font-medium"
                            >
                                {{ mov.almacen }}
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-700">
                                {{ mov.fecha }}
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-700">
                                {{ mov.item }}
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-700">
                                {{ mov.cantidad }}
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-700">
                            <span
                                class="px-3 py-1 rounded-full text-xs font-semibold"
                                [ngClass]="{
                                    'bg-green-100 text-green-700':
                                        mov.movimiento === 'Entrada',
                                    'bg-red-100 text-red-700':
                                        mov.movimiento === 'Salida'
                                }"
                            >
                                {{ mov.movimiento }}
                            </span>
                            </td>

                            <!-- Acciones -->
                            <td class="px-6 py-4 flex justify-center gap-4">
                                <button mat-icon-button [routerLink]="['/movimiento-edit', mov.id]" title="Editar" class="p-2 rounded-full bg-blue-50 hover:bg-blue-100 transition-all duration-300 hover:scale-110">
                                    <mat-icon
                                        [svgIcon]="'heroicons_outline:pencil-square'"
                                    ></mat-icon>
                                </button>

                                <button
                                    type="button"
                                    title="Ver"
                                    (click)="verMovimiento(mov)"
                                    class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
                                >
                                    <mat-icon class="icon-size-5">visibility</mat-icon>
                                </button>


                                <button (click)="eliminarMovimiento(mov)" title="Eliminar" class="p-2 rounded-full bg-red-50 hover:bg-red-100 transition-all duration-300 hover:scale-110">
                                    <mat-icon
                                        [svgIcon]="'mat_solid:delete'"
                                    ></mat-icon>
                                </button>
                            </td>
                        </tr>
                    } @empty {
                        <tr>
                            <td
                                colspan="6"
                                class="px-6 py-8 text-center text-gray-500 italic animate-fade-in"
                            >
                                No se encontraron registros con los filtros
                                seleccionados üïµÔ∏è‚Äç‚ôÇÔ∏è
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- üîπ PAGINADOR -->
        <div class="flex justify-end mt-4">
            <mat-paginator
                [length]="movimientosFiltrados.length"
                [pageSize]="pageSize"
                [pageSizeOptions]="[5, 10, 25]"
                showFirstLastButtons
                (page)="onPageChange($event)"
                class="bg-white rounded-xl border border-gray-200 shadow-md"
            >
            </mat-paginator>
        </div>
    </div>
</div>
