<div class="w-full flex-auto p-6 sm:p-10 bg-gray-50 min-h-screen">

    <div class="mb-8">
        <h2 class="text-3xl font-bold tracking-tight text-blue-900">Seguimiento de Compras</h2>
        <p class="text-gray-500">Control de entregas parciales y stock en tránsito hacia Viru Viru.</p>
    </div>

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <table class="w-full">
            <thead class="bg-gray-100">
            <tr>
                <th class="p-4 text-left font-bold text-gray-600">Ítem / Proveedor</th>
                <th class="p-4 text-center font-bold text-gray-600">Fecha</th>
                <th class="p-4 text-center font-bold text-gray-600">Solicitado</th>
                <th class="p-4 text-left font-bold text-gray-600 w-1/3">Progreso de Entrega</th>
                <th class="p-4 text-right font-bold text-gray-600">Acción</th>
            </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                @for (item of seguimientoCompras; track item.id) {
                    <tr class="hover:bg-blue-50 transition-colors">

                        <td class="p-4">
                            <div class="font-bold text-gray-800">{{ item.nombreItem }}</div>
                            <div class="text-xs text-gray-500">{{ item.proveedor }}</div>
                        </td>

                        <td class="p-4 text-center text-gray-600">{{ item.fechaSolicitud }}</td>

                        <td class="p-4 text-center">
                            <span class="font-bold text-lg">{{ item.cantidadTotal }}</span>
                        </td>

                        <td class="p-4 align-middle">
                            <div class="flex justify-between text-xs mb-1 font-medium">
                                <span class="text-gray-600">Recibido: {{ item.cantidadEntregada }}</span>
                                <span class="text-blue-600">{{ getPorcentaje(item) | number:'1.0-0' }}%</span>
                            </div>
                            <mat-progress-bar mode="determinate" [value]="getPorcentaje(item)"
                                              [class.mat-primary]="item.estado !== 'Completado'"
                                              [class.mat-accent]="item.estado === 'Completado'">
                            </mat-progress-bar>
                            <div class="text-xs text-gray-400 mt-1">Estado:
                                <span class="font-bold" [class.text-green-600]="item.estado === 'Completado'" [class.text-orange-500]="item.estado !== 'Completado'">
                                    {{ item.estado }}
                                </span>
                            </div>
                        </td>

                        <td class="p-4 text-right">
                            <button mat-stroked-button color="primary"
                                    (click)="registrarEntrega(item)"
                                    [disabled]="item.estado === 'Completado'">
                                <mat-icon>archive</mat-icon>
                                Recibir
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
